<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ImageInfo.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">org.apache.xmlgraphics:xmlgraphics-commons</a> &gt; <a href="index.source.html" class="el_package">org.apache.xmlgraphics.image.codec.tiff</a> &gt; <span class="el_source">ImageInfo.java</span></div><h1>ImageInfo.java</h1><pre class="source lang-java linenums">/* $$ This file has been instrumented by Clover 4.5.2#20240131180750 $$ *//*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.apache.xmlgraphics.image.codec.tiff;

import java.awt.color.ColorSpace;
import java.awt.image.ColorModel;
import java.awt.image.IndexColorModel;
import java.awt.image.RenderedImage;

<span class="pc bpc" id="L25" title="3 of 4 branches missed.">final class ImageInfo {public static class __CLR4_5_23u43u4m68iygbz{public static com_atlassian_clover.CoverageRecorder R;public static com_atlassian_clover.CloverProfile[] profiles = { };@java.lang.SuppressWarnings(&quot;unchecked&quot;) public static &lt;I, T extends I&gt; I lambdaInc(final int i,final T l,final int si){java.lang.reflect.InvocationHandler h=new java.lang.reflect.InvocationHandler(){public java.lang.Object invoke(java.lang.Object p,java.lang.reflect.Method m,java.lang.Object[] a) throws Throwable{R.inc(i);R.inc(si);try{return m.invoke(l,a);}catch(java.lang.reflect.InvocationTargetException e){throw e.getCause()!=null?e.getCause():new RuntimeException(&quot;Clover failed to invoke instrumented lambda&quot;,e);}}};return (I)java.lang.reflect.Proxy.newProxyInstance(l.getClass().getClassLoader(),l.getClass().getInterfaces(),h);}public static &lt;T&gt; T caseInc(int i,java.util.function.Supplier&lt;T&gt; s){R.inc(i);return s.get();}public static void caseInc(int i,Runnable r){R.inc(i);r.run();}static{com_atlassian_clover.CoverageRecorder _R=null;try{com_atlassian_clover.CloverVersionInfo.An_old_version_of_clover_is_on_your_compilation_classpath___Please_remove___Required_version_is___4_5_2();if(20240131180750L!=com_atlassian_clover.CloverVersionInfo.getBuildStamp()){com_atlassian_clover.Clover.l(&quot;[CLOVER] WARNING: The Clover version used in instrumentation shall match the runtime version.&quot;);com_atlassian_clover.Clover.l(&quot;[CLOVER] WARNING: Instr=4.5.2#20240131180750,Runtime=&quot;+com_atlassian_clover.CloverVersionInfo.getReleaseNum()+&quot;#&quot;+com_atlassian_clover.CloverVersionInfo.getBuildStamp());}R=com_atlassian_clover.Clover.getNullRecorder();_R=com_atlassian_clover.Clover.getNullRecorder();_R=com_atlassian_clover.Clover.getRecorder(&quot;\u002f\u0063\u006f\u0064\u0065\u002f\u0063\u006f\u006e\u0063\u006f\u0072\u0064\u0069\u0061\u002f\u0053\u004f\u0045\u004e\u002d\u0033\u0034\u0035\u002d\u0054\u0075\u0074\u006f\u0072\u0069\u0061\u006c\u0073\u002f\u0074\u0075\u0074\u006f\u0072\u0069\u0061\u006c\u0031\u002f\u0050\u0061\u0072\u0074\u002d\u0042\u002f\u0078\u006d\u006c\u0067\u0072\u0061\u0070\u0068\u0069\u0063\u0073\u002d\u0063\u006f\u006d\u006d\u006f\u006e\u0073\u002d\u0032\u002e\u0038\u002f\u0074\u0061\u0072\u0067\u0065\u0074\u002f\u0063\u006c\u006f\u0076\u0065\u0072\u002f\u0063\u006c\u006f\u0076\u0065\u0072\u002e\u0064\u0062&quot;,1737587872955L,8589935092L,5096,profiles,new java.lang.String[]{&quot;clover.distributed.coverage&quot;,null});}catch(java.lang.SecurityException e){java.lang.System.err.println(&quot;[CLOVER] FATAL ERROR: Clover could not be initialised because it has insufficient security privileges. Please consult the Clover documentation on the security policy file changes required. (&quot;+e.getClass()+&quot;:&quot;+e.getMessage()+&quot;)&quot;);}catch(java.lang.NoClassDefFoundError e){java.lang.System.err.println(&quot;[CLOVER] FATAL ERROR: Clover could not be initialised. Are you sure you have Clover in the runtime classpath? (&quot;+e.getClass()+&quot;:&quot;+e.getMessage()+&quot;)&quot;);}catch(java.lang.Throwable t){java.lang.System.err.println(&quot;[CLOVER] FATAL ERROR: Clover could not be initialised because of an unexpected error. (&quot;+t.getClass()+&quot;:&quot;+t.getMessage()+&quot;)&quot;);}R=_R;}}public static final com_atlassian_clover.TestNameSniffer __CLR4_5_2_TEST_NAME_SNIFFER=com_atlassian_clover.TestNameSniffer.NULL_INSTANCE;</span>

    // Default values
    private static final int DEFAULT_ROWS_PER_STRIP = 8;

    private final int numExtraSamples;
    private final ExtraSamplesType extraSampleType;
    private final ImageType imageType;
    private final int colormapSize;
    private final char[] colormap;
    private final int tileWidth;
    private final int tileHeight;
    private final int numTiles;
    private final long bytesPerRow;
    private final long bytesPerTile;

<span class="fc" id="L41">    private ImageInfo(ImageInfoBuilder builder) {try{__CLR4_5_23u43u4m68iygbz.R.inc(4972);</span>
<span class="fc" id="L42">        __CLR4_5_23u43u4m68iygbz.R.inc(4973);this.numExtraSamples = builder.numExtraSamples;</span>
<span class="fc" id="L43">        __CLR4_5_23u43u4m68iygbz.R.inc(4974);this.extraSampleType = builder.extraSampleType;</span>
<span class="fc" id="L44">        __CLR4_5_23u43u4m68iygbz.R.inc(4975);this.imageType = builder.imageType;</span>
<span class="fc" id="L45">        __CLR4_5_23u43u4m68iygbz.R.inc(4976);this.colormapSize = builder.colormapSize;</span>
<span class="fc" id="L46">        __CLR4_5_23u43u4m68iygbz.R.inc(4977);this.colormap = copyColormap(builder.colormap);</span>
<span class="fc" id="L47">        __CLR4_5_23u43u4m68iygbz.R.inc(4978);this.tileWidth = builder.tileWidth;</span>
<span class="fc" id="L48">        __CLR4_5_23u43u4m68iygbz.R.inc(4979);this.tileHeight = builder.tileHeight;</span>
<span class="fc" id="L49">        __CLR4_5_23u43u4m68iygbz.R.inc(4980);this.numTiles = builder.numTiles;</span>
<span class="fc" id="L50">        __CLR4_5_23u43u4m68iygbz.R.inc(4981);this.bytesPerRow = builder.bytesPerRow;</span>
<span class="fc" id="L51">        __CLR4_5_23u43u4m68iygbz.R.inc(4982);this.bytesPerTile = builder.bytesPerTile;</span>
<span class="fc" id="L52">    }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

<span class="fc" id="L54">    private static char[] copyColormap(char[] colorMap) {try{__CLR4_5_23u43u4m68iygbz.R.inc(4983);</span>
<span class="pc bpc" id="L55" title="4 of 10 branches missed.">        __CLR4_5_23u43u4m68iygbz.R.inc(4984);if ((((colorMap == null)&amp;&amp;(__CLR4_5_23u43u4m68iygbz.R.iget(4985)!=0|true))||(__CLR4_5_23u43u4m68iygbz.R.iget(4986)==0&amp;false))) {{</span>
<span class="fc" id="L56">            __CLR4_5_23u43u4m68iygbz.R.inc(4987);return null;</span>
        }
<span class="fc" id="L58">        }__CLR4_5_23u43u4m68iygbz.R.inc(4988);char[] copy = new char[colorMap.length];</span>
<span class="fc" id="L59">        __CLR4_5_23u43u4m68iygbz.R.inc(4989);System.arraycopy(colorMap, 0, copy, 0, colorMap.length);</span>
<span class="fc" id="L60">        __CLR4_5_23u43u4m68iygbz.R.inc(4990);return copy;</span>
<span class="fc" id="L61">    }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

    private static int getNumberOfExtraSamplesForColorSpace(ColorSpace colorSpace,
<span class="fc" id="L64">            ImageType imageType, int numBands) {try{__CLR4_5_23u43u4m68iygbz.R.inc(4991);</span>
<span class="pc bpc" id="L65" title="4 of 10 branches missed.">        __CLR4_5_23u43u4m68iygbz.R.inc(4992);if ((((imageType == ImageType.GENERIC)&amp;&amp;(__CLR4_5_23u43u4m68iygbz.R.iget(4993)!=0|true))||(__CLR4_5_23u43u4m68iygbz.R.iget(4994)==0&amp;false))) {{</span>
<span class="fc" id="L66">            __CLR4_5_23u43u4m68iygbz.R.inc(4995);return numBands - 1;</span>
<span class="pc bpc" id="L67" title="4 of 10 branches missed.">        } }else {__CLR4_5_23u43u4m68iygbz.R.inc(4996);if ((((numBands &gt; 1)&amp;&amp;(__CLR4_5_23u43u4m68iygbz.R.iget(4997)!=0|true))||(__CLR4_5_23u43u4m68iygbz.R.iget(4998)==0&amp;false))) {{</span>
<span class="fc" id="L68">            __CLR4_5_23u43u4m68iygbz.R.inc(4999);return numBands - colorSpace.getNumComponents();</span>
        } }else {{
<span class="fc" id="L70">            __CLR4_5_23u43u4m68iygbz.R.inc(5000);return 0;</span>
        }
<span class="fc" id="L72">    }}}finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

<span class="fc" id="L74">    private static char[] createColormap(final int sizeOfColormap, byte[] r, byte[] g, byte[] b) {try{__CLR4_5_23u43u4m68iygbz.R.inc(5001);</span>
<span class="fc" id="L75">        __CLR4_5_23u43u4m68iygbz.R.inc(5002);int redIndex = 0;</span>
<span class="fc" id="L76">        __CLR4_5_23u43u4m68iygbz.R.inc(5003);int greenIndex = sizeOfColormap;</span>
<span class="fc" id="L77">        __CLR4_5_23u43u4m68iygbz.R.inc(5004);int blueIndex = 2 * sizeOfColormap;</span>
<span class="fc" id="L78">        __CLR4_5_23u43u4m68iygbz.R.inc(5005);char[] colormap = new char[sizeOfColormap * 3];</span>
<span class="pc bpc" id="L79" title="4 of 10 branches missed.">        __CLR4_5_23u43u4m68iygbz.R.inc(5006);for (int i = 0; (((i &lt; sizeOfColormap)&amp;&amp;(__CLR4_5_23u43u4m68iygbz.R.iget(5007)!=0|true))||(__CLR4_5_23u43u4m68iygbz.R.iget(5008)==0&amp;false)); i++) {{</span>
            // beware of sign extended bytes
<span class="fc" id="L81">            __CLR4_5_23u43u4m68iygbz.R.inc(5009);colormap[redIndex++] = convertColorToColormapChar(0xff &amp; r[i]);</span>
<span class="fc" id="L82">            __CLR4_5_23u43u4m68iygbz.R.inc(5010);colormap[greenIndex++] = convertColorToColormapChar(0xff &amp; g[i]);</span>
<span class="fc" id="L83">            __CLR4_5_23u43u4m68iygbz.R.inc(5011);colormap[blueIndex++] = convertColorToColormapChar(0xff &amp; b[i]);</span>
        }
<span class="fc" id="L85">        }__CLR4_5_23u43u4m68iygbz.R.inc(5012);return colormap;</span>
<span class="fc" id="L86">    }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

<span class="fc" id="L88">    private static char convertColorToColormapChar(int color) {try{__CLR4_5_23u43u4m68iygbz.R.inc(5013);</span>
<span class="fc" id="L89">        __CLR4_5_23u43u4m68iygbz.R.inc(5014);return (char) (color &lt;&lt; 8 | color);</span>
<span class="fc" id="L90">    }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

<span class="fc" id="L92">    int getNumberOfExtraSamples() {try{__CLR4_5_23u43u4m68iygbz.R.inc(5015);</span>
<span class="fc" id="L93">        __CLR4_5_23u43u4m68iygbz.R.inc(5016);return numExtraSamples;</span>
<span class="fc" id="L94">    }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

<span class="fc" id="L96">    ExtraSamplesType getExtraSamplesType() {try{__CLR4_5_23u43u4m68iygbz.R.inc(5017);</span>
<span class="fc" id="L97">        __CLR4_5_23u43u4m68iygbz.R.inc(5018);return extraSampleType;</span>
<span class="fc" id="L98">    }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

<span class="fc" id="L100">    ImageType getType() {try{__CLR4_5_23u43u4m68iygbz.R.inc(5019);</span>
<span class="fc" id="L101">        __CLR4_5_23u43u4m68iygbz.R.inc(5020);return imageType;</span>
<span class="fc" id="L102">    }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

<span class="fc" id="L104">    int getColormapSize() {try{__CLR4_5_23u43u4m68iygbz.R.inc(5021);</span>
<span class="fc" id="L105">        __CLR4_5_23u43u4m68iygbz.R.inc(5022);return colormapSize;</span>
<span class="fc" id="L106">    }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

<span class="fc" id="L108">    char[] getColormap() {try{__CLR4_5_23u43u4m68iygbz.R.inc(5023);</span>
<span class="fc" id="L109">        __CLR4_5_23u43u4m68iygbz.R.inc(5024);return copyColormap(colormap);</span>
<span class="fc" id="L110">    }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

<span class="fc" id="L112">    int getTileWidth() {try{__CLR4_5_23u43u4m68iygbz.R.inc(5025);</span>
<span class="fc" id="L113">        __CLR4_5_23u43u4m68iygbz.R.inc(5026);return tileWidth;</span>
<span class="fc" id="L114">    }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

<span class="fc" id="L116">    int getTileHeight() {try{__CLR4_5_23u43u4m68iygbz.R.inc(5027);</span>
<span class="fc" id="L117">        __CLR4_5_23u43u4m68iygbz.R.inc(5028);return tileHeight;</span>
<span class="fc" id="L118">    }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

<span class="fc" id="L120">    int getNumTiles() {try{__CLR4_5_23u43u4m68iygbz.R.inc(5029);</span>
<span class="fc" id="L121">        __CLR4_5_23u43u4m68iygbz.R.inc(5030);return numTiles;</span>
<span class="fc" id="L122">    }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

<span class="fc" id="L124">    long getBytesPerRow() {try{__CLR4_5_23u43u4m68iygbz.R.inc(5031);</span>
<span class="fc" id="L125">        __CLR4_5_23u43u4m68iygbz.R.inc(5032);return bytesPerRow;</span>
<span class="fc" id="L126">    }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

<span class="fc" id="L128">    long getBytesPerTile() {try{__CLR4_5_23u43u4m68iygbz.R.inc(5033);</span>
<span class="fc" id="L129">        __CLR4_5_23u43u4m68iygbz.R.inc(5034);return bytesPerTile;</span>
<span class="fc" id="L130">    }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

    static ImageInfo newInstance(RenderedImage im, int dataTypeSize, int numBands,
<span class="fc" id="L133">            ColorModel colorModel, TIFFEncodeParam params) {try{__CLR4_5_23u43u4m68iygbz.R.inc(5035);</span>
<span class="fc" id="L134">        __CLR4_5_23u43u4m68iygbz.R.inc(5036);ImageInfoBuilder builder = new ImageInfoBuilder();</span>
<span class="pc bpc" id="L135" title="4 of 10 branches missed.">        __CLR4_5_23u43u4m68iygbz.R.inc(5037);if ((((colorModel instanceof IndexColorModel)&amp;&amp;(__CLR4_5_23u43u4m68iygbz.R.iget(5038)!=0|true))||(__CLR4_5_23u43u4m68iygbz.R.iget(5039)==0&amp;false))) {{ // Bilevel or palette</span>
<span class="fc" id="L136">            __CLR4_5_23u43u4m68iygbz.R.inc(5040);IndexColorModel indexColorModel = (IndexColorModel) colorModel;</span>
<span class="fc" id="L137">            __CLR4_5_23u43u4m68iygbz.R.inc(5041);int colormapSize = indexColorModel.getMapSize();</span>
<span class="fc" id="L138">            __CLR4_5_23u43u4m68iygbz.R.inc(5042);byte[] r = new byte[colormapSize];</span>
<span class="fc" id="L139">            __CLR4_5_23u43u4m68iygbz.R.inc(5043);indexColorModel.getReds(r);</span>
<span class="fc" id="L140">            __CLR4_5_23u43u4m68iygbz.R.inc(5044);byte[] g = new byte[colormapSize];</span>
<span class="fc" id="L141">            __CLR4_5_23u43u4m68iygbz.R.inc(5045);indexColorModel.getGreens(g);</span>
<span class="fc" id="L142">            __CLR4_5_23u43u4m68iygbz.R.inc(5046);byte[] b = new byte[colormapSize];</span>
<span class="fc" id="L143">            __CLR4_5_23u43u4m68iygbz.R.inc(5047);indexColorModel.getBlues(b);</span>

<span class="fc" id="L145">            __CLR4_5_23u43u4m68iygbz.R.inc(5048);builder.imageType = ImageType.getTypeFromRGB(colormapSize, r, g, b, dataTypeSize,</span>
                    numBands);
<span class="pc bpc" id="L147" title="4 of 10 branches missed.">            __CLR4_5_23u43u4m68iygbz.R.inc(5049);if ((((builder.imageType == ImageType.PALETTE)&amp;&amp;(__CLR4_5_23u43u4m68iygbz.R.iget(5050)!=0|true))||(__CLR4_5_23u43u4m68iygbz.R.iget(5051)==0&amp;false))) {{</span>
<span class="fc" id="L148">                __CLR4_5_23u43u4m68iygbz.R.inc(5052);builder.colormap = createColormap(colormapSize, r, g, b);</span>
<span class="fc" id="L149">                __CLR4_5_23u43u4m68iygbz.R.inc(5053);builder.colormapSize = colormapSize * 3;</span>
            }
<span class="pc bpc" id="L151" title="4 of 10 branches missed.">        }} }else {__CLR4_5_23u43u4m68iygbz.R.inc(5054);if ((((colorModel == null)&amp;&amp;(__CLR4_5_23u43u4m68iygbz.R.iget(5055)!=0|true))||(__CLR4_5_23u43u4m68iygbz.R.iget(5056)==0&amp;false))) {{</span>
<span class="pc bpc" id="L152" title="5 of 12 branches missed.">            __CLR4_5_23u43u4m68iygbz.R.inc(5057);if ((((dataTypeSize == 1 &amp;&amp; numBands == 1)&amp;&amp;(__CLR4_5_23u43u4m68iygbz.R.iget(5058)!=0|true))||(__CLR4_5_23u43u4m68iygbz.R.iget(5059)==0&amp;false))) {{ // bilevel</span>
<span class="fc" id="L153">                __CLR4_5_23u43u4m68iygbz.R.inc(5060);builder.imageType = ImageType.BILEVEL_BLACK_IS_ZERO;</span>
            } }else {{
<span class="fc" id="L155">                __CLR4_5_23u43u4m68iygbz.R.inc(5061);builder.imageType = ImageType.GENERIC;</span>
<span class="pc bpc" id="L156" title="7 of 10 branches missed.">                __CLR4_5_23u43u4m68iygbz.R.inc(5062);builder.numExtraSamples = (((numBands &gt; 1 )&amp;&amp;(__CLR4_5_23u43u4m68iygbz.R.iget(5063)!=0|true))||(__CLR4_5_23u43u4m68iygbz.R.iget(5064)==0&amp;false))? numBands - 1 : 0;</span>
            }
        }} }else {{
<span class="fc" id="L159">            __CLR4_5_23u43u4m68iygbz.R.inc(5065);ColorSpace colorSpace = colorModel.getColorSpace();</span>
<span class="fc" id="L160">            __CLR4_5_23u43u4m68iygbz.R.inc(5066);builder.imageType = ImageType.getTypeFromColorSpace(colorSpace, params);</span>
<span class="fc" id="L161">            __CLR4_5_23u43u4m68iygbz.R.inc(5067);builder.numExtraSamples = getNumberOfExtraSamplesForColorSpace(colorSpace,</span>
<span class="fc" id="L162">                    builder.imageType, numBands);</span>
<span class="fc" id="L163">            __CLR4_5_23u43u4m68iygbz.R.inc(5068);builder.extraSampleType = ExtraSamplesType.getValue(colorModel,</span>
<span class="fc" id="L164">                    builder.numExtraSamples);</span>
        }

        // Initialize tile dimensions.
<span class="fc" id="L168">        }}__CLR4_5_23u43u4m68iygbz.R.inc(5069);final int width = im.getWidth();</span>
<span class="fc" id="L169">        __CLR4_5_23u43u4m68iygbz.R.inc(5070);final int height = im.getHeight();</span>
<span class="pc bpc" id="L170" title="4 of 10 branches missed.">        __CLR4_5_23u43u4m68iygbz.R.inc(5071);if ((((params.getWriteTiled())&amp;&amp;(__CLR4_5_23u43u4m68iygbz.R.iget(5072)!=0|true))||(__CLR4_5_23u43u4m68iygbz.R.iget(5073)==0&amp;false))) {{</span>
<span class="pc bpc" id="L171" title="7 of 10 branches missed.">            __CLR4_5_23u43u4m68iygbz.R.inc(5074);builder.tileWidth = (((params.getTileWidth() &gt; 0 )&amp;&amp;(__CLR4_5_23u43u4m68iygbz.R.iget(5075)!=0|true))||(__CLR4_5_23u43u4m68iygbz.R.iget(5076)==0&amp;false))? params.getTileWidth() : width;</span>
<span class="pc bpc" id="L172" title="7 of 10 branches missed.">            __CLR4_5_23u43u4m68iygbz.R.inc(5077);builder.tileHeight = (((params.getTileHeight() &gt; 0 )&amp;&amp;(__CLR4_5_23u43u4m68iygbz.R.iget(5078)!=0|true))||(__CLR4_5_23u43u4m68iygbz.R.iget(5079)==0&amp;false))? params.getTileHeight() : height;</span>
            // NB: Parentheses are used in this statement for correct rounding.
<span class="fc" id="L174">            __CLR4_5_23u43u4m68iygbz.R.inc(5080);builder.numTiles = ((width + builder.tileWidth - 1) / builder.tileWidth)</span>
<span class="fc" id="L175">                    * ((height + builder.tileHeight - 1) / builder.tileHeight);</span>
        } }else {{
<span class="fc" id="L177">            __CLR4_5_23u43u4m68iygbz.R.inc(5081);builder.tileWidth = width;</span>
<span class="pc bpc" id="L178" title="7 of 10 branches missed.">            __CLR4_5_23u43u4m68iygbz.R.inc(5082);builder.tileHeight = (((params.getTileHeight() &gt; 0 )&amp;&amp;(__CLR4_5_23u43u4m68iygbz.R.iget(5083)!=0|true))||(__CLR4_5_23u43u4m68iygbz.R.iget(5084)==0&amp;false))? params.getTileHeight()</span>
<span class="fc" id="L179">                    : DEFAULT_ROWS_PER_STRIP;</span>
<span class="fc" id="L180">            __CLR4_5_23u43u4m68iygbz.R.inc(5085);builder.numTiles = (int) Math.ceil(height / (double) builder.tileHeight);</span>
        }
<span class="fc" id="L182">        }__CLR4_5_23u43u4m68iygbz.R.inc(5086);builder.setBytesPerRow(dataTypeSize, numBands)</span>
<span class="fc" id="L183">        .setBytesPerTile();</span>
<span class="fc" id="L184">        __CLR4_5_23u43u4m68iygbz.R.inc(5087);return builder.build();</span>
<span class="fc" id="L185">    }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

<span class="fc" id="L187">    private static final class ImageInfoBuilder {</span>
<span class="fc" id="L188">        private ImageType imageType = ImageType.UNSUPPORTED;</span>
        private int numExtraSamples;
        private char[] colormap;
        private int colormapSize;
<span class="fc" id="L192">        private ExtraSamplesType extraSampleType = ExtraSamplesType.UNSPECIFIED;</span>
        private int tileWidth;
        private int tileHeight;
        private int numTiles;
        private long bytesPerRow;
        private long bytesPerTile;

<span class="fc" id="L199">        private ImageInfoBuilder setBytesPerRow(int dataTypeSize, int numBands) {try{__CLR4_5_23u43u4m68iygbz.R.inc(5088);</span>
<span class="fc" id="L200">            __CLR4_5_23u43u4m68iygbz.R.inc(5089);bytesPerRow = (long) Math.ceil((dataTypeSize / 8.0) * tileWidth * numBands);</span>
<span class="fc" id="L201">            __CLR4_5_23u43u4m68iygbz.R.inc(5090);return this;</span>
<span class="fc" id="L202">        }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

<span class="fc" id="L204">        private ImageInfoBuilder setBytesPerTile() {try{__CLR4_5_23u43u4m68iygbz.R.inc(5091);</span>
<span class="fc" id="L205">            __CLR4_5_23u43u4m68iygbz.R.inc(5092);bytesPerTile = bytesPerRow * tileHeight;</span>
<span class="fc" id="L206">            __CLR4_5_23u43u4m68iygbz.R.inc(5093);return this;</span>
<span class="fc" id="L207">        }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>

<span class="fc" id="L209">        private ImageInfo build() {try{__CLR4_5_23u43u4m68iygbz.R.inc(5094);</span>
<span class="fc" id="L210">            __CLR4_5_23u43u4m68iygbz.R.inc(5095);return new ImageInfo(this);</span>
<span class="fc" id="L211">        }finally{__CLR4_5_23u43u4m68iygbz.R.flushNeeded();}}</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>